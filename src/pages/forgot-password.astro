---
import Layout from '../layouts/Layout.astro';
const pageTitle = "Forgot Password?";
const sent = Astro.url.searchParams.get('sent') === '1';
const err = Astro.url.searchParams.get('err');
const errors: Record<string, string> = {
  missing: "Please enter your email address.",
  bad: "We couldnâ€™t send a reset email. Please try again.",
};
---

<Layout pageTitle={pageTitle}>
  <div class="mt-5 max-w-md mx-auto bg-white text-black p-6 border-2 border-gray-300 rounded">
    <h1 class="text-2xl font-bold mb-4">{pageTitle}</h1>

    {sent && (
      <div class="mb-4 rounded-md border border-green-600 bg-green-900/30 text-green-300 px-3 py-2 text-sm">
        If that email is registered, a password reset link has been sent. Please check your inbox.
      </div>
    )}

    {err && (
      <div class="mb-4 rounded-md border border-red-600 bg-red-900/30 text-red-300 px-3 py-2 text-sm">
        {errors[err] ?? "Something went wrong. Please try again."}
      </div>
    )}

    <form class="flex flex-col gap-4" method="post" action="/api/forgot-password">
      <input
        type="email"
        name="email"
        placeholder="Email"
        required
        class="border border-gray-300 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-black"
        autocomplete="email"
      />
      <button type="submit" class="text-white py-2 px-4 rounded acornblue">
        Send reset link
      </button>
    </form>

    <p class="mt-4 text-sm">
      Remembered it? <a href="/login" class="underline">Back to login</a>
    </p>
  </div>
</Layout>
